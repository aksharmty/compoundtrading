<!DOCTYPE html>
<html lang="en">
<head>
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4305348743992957"
     crossorigin="anonymous"></script>     
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel='shortcut icon' href='logo.png' type='image/x-icon' />
  <title>DCA Down Calculator</title>
  <meta name="description" content="DCA calculator">
  <meta name="keywords" content="Compound Trading, Compounding Strategy, Trading Bot, Automated Trading, Profit Growth, Trading Education,dca calculator">
  <LINK href="0.css" rel="stylesheet" type="text/css">
</head>
<body>
  <div class="col-md-12" style="width:100%;">
        <div id="menu"></div>
    </div>
    <div class="row">
        <div class="col-md-12">
          <div class="left-panel">
              <div class="col-md-12" style="width:100%;">
        <center><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4305348743992957"
     crossorigin="anonymous"></script>
<!-- sakhiadheader -->
<ins class="adsbygoogle"
     style="display:inline-block;width:728px;height:90px;max-height:100px;"
     data-ad-client="ca-pub-4305348743992957"
     data-ad-slot="1924539816"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
</center>
    </div>
                    <div class="col-md-12">
  <h1 style="text-align:center;">DCA Price Drop Calculator</h1>
   <style>
   .box { border: 1px solid #ccc; padding: 20px; border-radius: 10px; }
    input[type="number"] { width: 100%; padding: 10px; margin: 8px 0; box-sizing: border-box; }
    label { font-weight: 600; display:block; margin-top:10px }
    button { padding: 10px 16px; font-size: 16px; cursor: pointer; margin-top: 12px }
    .output { margin-top: 20px; padding: 15px; background: #f7f7f7; border-radius: 10px; }
    table { width:100%; border-collapse: collapse; margin-top:12px }
    table th, table td { border:1px solid #ddd; padding:6px 8px; text-align:right }
    table th { background:#f0f0f0; text-align:center }
    .small { font-size:0.9em; color:#555 }
    .controls { display:flex; gap:10px; align-items:center }
    .mono { font-family: monospace }
  </style>
  <div class="box">
      <div class="col">
        <label>Last Buy Gap (%)</label>
        <input type="number" id="gap" value="1" step="0.1" min="0">
      </div>
      <div class="col">
        <label>Buy Amount Increase (%)</label>
        <input type="number" id="inc" value="1" step="0.1" min="0">
      </div>
    
       <div class="col">
        <label>Total Capital (₹)</label>
        <input type="number" id="capital" value="100000" step="any" min="0">
      </div>
      <div class="col">
        <label>First Buy (% of Capital)</label>
        <input type="number" id="first" value="1" step="0.1" min="0">
      </div>
    
    <div class="controls">
      <button id="calcBtn">Calculate</button>
      <button id="exportCsvBtn">Export CSV</button>
    </div>

    <div id="result" class="output"></div>
  </div>

  <script>
    // store last run data for CSV export
    let lastRun = { steps: [], buyAmounts: [], prices: [], cumulative: [], capital: 0 };

    function calc() {
      // read inputs
      const gap = parseFloat(document.getElementById('gap').value) / 100;
      const inc = parseFloat(document.getElementById('inc').value) / 100;
      const capital = parseFloat(document.getElementById('capital').value);
      const firstPct = parseFloat(document.getElementById('first').value) / 100;

      if (!isFinite(gap) || !isFinite(inc) || !isFinite(capital) || !isFinite(firstPct) || capital <= 0 || firstPct <= 0) {
        document.getElementById('result').innerHTML = '<span class="small">Please enter valid positive numbers (capital &amp; first buy % must be &gt; 0).</span>';
        lastRun = { steps: [], buyAmounts: [], prices: [], cumulative: [], capital: 0 };
        return;
      }

      // Simulation arrays
      const buyAmounts = [];
      const prices = [];
      const cumulative = [];

      let used = 0;
      let buyAmount = capital * firstPct;
      let price = 1; // relative to start
      let step = 0;

      while (used + buyAmount <= capital) {
        used += buyAmount;
        step += 1;
        // price after this step
        price = price * (1 - gap);
        buyAmounts.push(buyAmount);
        prices.push(price);
        cumulative.push(used);
        // next buy amount increases
        buyAmount = buyAmount * (1 + inc);
        // safety guard
        if (step > 1000000) break;
      }

      const totalDownPct = (1 - price) * 100;

      // Save for export
      lastRun = { steps: Array.from({length: step}, (_,i)=>i+1), buyAmounts: buyAmounts.slice(), prices: prices.slice(), cumulative: cumulative.slice(), capital };

      // Build output HTML
      let html = `
        <div><b>Total Buys:</b> ${step}</div>
        <div><b>Total Down Covered:</b> ${totalDownPct.toFixed(2)}%</div>
        <div><b>Capital Used:</b> ₹${used.toFixed(2)}</div>
      `;

      if (step === 0) {
        html += `<div class="small">No buys could be made with given inputs.</div>`;
      } else {
        html += `
          <div style="overflow:auto; max-height:420px; margin-top:10px">
            <table>
              <thead>
                <tr>
                  <th>Step</th>
                  <th>Price (relative)</th>
                  <th>Buy Amount (₹)</th>
                  <th>Cumulative Invested (₹)</th>
                </tr>
              </thead>
              <tbody>
        `;

        for (let i = 0; i < step; i++) {
          html += `<tr>` +
                  `<td style='text-align:center'>${i+1}</td>` +
                  `<td class='mono'>${prices[i].toFixed(6)}</td>` +
                  `<td>${buyAmounts[i].toFixed(2)}</td>` +
                  `<td>${cumulative[i].toFixed(2)}</td>` +
                  `</tr>`;
        }

        html += `</tbody></table></div>`;
      }

      document.getElementById('result').innerHTML = html;
    }

    function exportCsv() {
      if (!lastRun || !lastRun.steps || lastRun.steps.length === 0) {
        alert('No data to export. Run Calculate first.');
        return;
      }
      let csv = 'Step,Price,BuyAmount,CumulativeInvested\n';
      for (let i = 0; i < lastRun.steps.length; i++) {
        csv += `${lastRun.steps[i]},${lastRun.prices[i].toFixed(6)},${lastRun.buyAmounts[i].toFixed(2)},${lastRun.cumulative[i].toFixed(2)}\n`;
      }
      const blob = new Blob([csv], { type: 'text/csv' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'dca_prices.csv';
      document.body.appendChild(a);
      a.click();
      a.remove();
      URL.revokeObjectURL(url);
    }

    document.getElementById('calcBtn').addEventListener('click', calc);
    document.getElementById('exportCsvBtn').addEventListener('click', exportCsv);

    // run once on load to show defaults
    window.addEventListener('load', calc);
  </script>
</div> </div>
        <div class="right-panel0">
            <div id="sidebar"></div>
        </div>
    </div></div>
    <div class="footer">
        <div id="footer"></div>
    </div>
    <button class="top-button" onclick="scrollToTop()">Back to Top</button>

    <div id="footer"></div>

    <script>
        // Toggle menu visibility on smaller screens
     function toggleMenu() {
       const menu = document.querySelector('.menu');
       menu.classList.toggle('show');
     }
     // Scroll to top function
    function scrollToTop() {
      window.scrollTo({
        top: 0,
        behavior: 'smooth'  // Smooth scroll effect
      });
    }

    // Show or hide the "Back to Top" button based on scroll position
    window.onscroll = function() {
      var topButton = document.querySelector('.top-button');
      if (document.body.scrollTop > 100 || document.documentElement.scrollTop > 100) {
        topButton.style.display = "block";  // Show button
      } else {
        topButton.style.display = "none";  // Hide button
      }
    };
   
    // Function to load external HTML into a specific element
    function loadHTML(elementId, file) {
      fetch(file)
        .then(response => response.text())
        .then(data => {
          document.getElementById(elementId).innerHTML = data;
        })
        .catch(error => {
          console.error('Error loading ' + file + ':', error);
        });
    }

    
    </script>
    <script src="js/loader.js"></script>
</body>
</html>
